{
  "version": 3,
  "sources": ["../node_modules/events/events.js", "../src/lib/coercion.ts", "../src/lib/constants.ts", "../src/lib/misc.ts", "../src/lib/errors/LocalizedError.ts", "../src/lib/errors/ActorNotActiveError.ts", "../src/lib/errors/ActorNotStagedError.ts", "../src/lib/errors/InvalidActorError.ts", "../src/lib/errors/InvalidFlyinError.ts", "../src/lib/errors/InvalidFontColorError.ts", "../src/lib/errors/InvalidFontError.ts", "../src/lib/errors/InvalidFontSizeError.ts", "../src/lib/errors/InvalidStandingError.ts", "../src/lib/errors/InvalidURLError.ts", "../src/lib/errors/NoChatHookError.ts", "../src/lib/staging.ts", "../src/lib/activation.ts", "../src/lib/emotes.ts", "../src/lib/narration.ts", "../src/lib/flyins.ts", "../src/lib/log.ts", "../src/lib/fonts.ts", "../src/lib/image.ts", "../src/lib/applications/IntroductionApplication.ts", "../src/lib/dynamicSelect.js", "../src/lib/applications/sharedFunctionality.ts", "../src/lib/messaging.ts", "../src/lib/sounds.ts", "../src/lib/introduction.ts", "../src/lib/mirror.ts", "../src/lib/standing.ts", "../src/lib/api.ts", "../src/lib/applications/SettingsHandler.ts", "../src/module.ts"],
  "sourcesContent": ["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-unsafe-return */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n\n/**\n * Retrieves an {@link Actor}\n * @param {unknown} arg A string id or name, or an {@link Actor}\n * @returns {Actor | undefined} {@link Actor} or undefined.\n */\nexport function coerceActor(arg: unknown): Actor | undefined | null {\n  if (arg instanceof Actor) return arg;\n  if (arg instanceof Token) return arg.actor;\n  if (typeof arg === \"string\") {\n    let actor = game.actors?.get(arg);\n    if (actor) return actor;\n    actor = game.actors?.getName(arg);\n    if (actor) return actor;\n  }\n}\n\n/**\n * Retrieves a {@link Playlist}\n * @param {unkown} arg A string id or name, or a {@link Playlist}\n * @returns {Playlist | undefined} {@link Playlist} or undefined\n */\nexport function coercePlaylist(arg: unknown): Playlist | undefined {\n  if (arg instanceof Playlist) return arg;\n  if (typeof arg === \"string\") {\n    let playlist = game.playlists?.get(arg);\n    if (playlist) return playlist;\n    playlist = game.playlists?.getName(arg);\n    if (playlist) return playlist;\n  }\n}\n\n/**\n * Retireves a {@link PlaylistSound} from a given {@link Playlist} by name, id, or {@link PlaylistSound}\n * @param {unknown} arg \n * @param {unknown} playlist\n */\nexport function coerceSound(arg: unknown, playlist: unknown): PlaylistSound | undefined {\n  if (arg instanceof PlaylistSound) return arg;\n\n  const actualPlaylist = coercePlaylist(playlist);\n  if (actualPlaylist && typeof arg === \"string\") {\n    let sound = actualPlaylist.sounds.get(arg);\n    if (sound instanceof PlaylistSound) return sound;\n    sound = actualPlaylist.sounds.getName(arg);\n    if (sound instanceof PlaylistSound) return sound;\n  }\n}\n\n/**\n * Retrieves an id for an {@link Actor}, given the id, name, or {@link Actor}\n * @param {unknown} arg \n */\nexport function coerceActorId(arg: unknown): string | undefined | null {\n  const actor = coerceActor(arg);\n  if (actor instanceof Actor) return actor.id;\n}\n\n/**\n * Retrieves an id for a given {@link Playlist}\n * @param {unknown} arg \n * @returns \n */\nexport function coercePlaylistId(arg: unknown): string | undefined | null {\n  const playlist = coercePlaylist(arg);\n  if (playlist instanceof Playlist) return playlist.id;\n}\n\n/**\n * Returns a {@link PlaylistSound} for a given id/name/{@link PlaylistSound} for a given {@link Playlist}\n * @param {unknown} arg \n * @param {unknown} playlist \n * @returns \n */\nexport function coerceSoundId(arg: unknown, playlist: unknown): string | undefined | null {\n  const sound = coerceSound(arg, playlist);\n  if (sound instanceof PlaylistSound) return sound.id;\n}", "/** Time to wait for activate/deactivate tween, in milliseconds */\nexport const TWEEN_WAIT_TIME = 1500;\n\n/** Time to wait for narrator bar to activate/deactivate, in milliseconds */\nexport const NARRATOR_WAIT_TIME = 500;\n\n/** URL to the typing indicator icon */\nexport const TYPING_ICON_URL: string = \"modules/theatre/assets/graphics/typing.png\";", "\n/**\n * Waits a specified amount of time, then resolves.\n * @param {number} ms Time, in milliseconds, to wait.\n * @returns \n */\nexport async function wait(ms: number): Promise<void> {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  })\n}\n\n/**\n * \n * @param alias \n * @param message \n */\nexport function sendChatMessage(alias: string, message: string) {\n  theatre.lastTyping = Date.now();\n  theatre.setUserTyping(game.user?.id, theatre.speakingAs);\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n  (<any>theatre)._sendTypingEvent();\n\n  const chatMessage = createChatMessage(alias, message);\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-explicit-any\n  ChatMessage.create(chatMessage as any);\n  // Hooks.callAll(\"createChatMessage\", chatMessage, { modifiedTime: Date.now(), parent: null, render: true, renderSheet: false }, game.user?.id);\n}\n\n/**\n * Creates a {@link ChatMessage}-like object to be passed to the createChatMessage hook to spoof input from a user\n * @param {string} alias Alias to set for the string.  Set to actor's name if an actor, \"narrator\" if narrator\n * @param {string} message \n */\nexport function createChatMessage(alias: string, message: string) {\n  return {\n    content: message,\n    style: 2,\n    author: game.user?.id,\n    _id: foundry.utils.randomID(),\n    type: \"base\",\n    system: {},\n    timestamp: Date.now(),\n    flavor: \"\",\n    speaker: {\n      scene: null,\n      actor: null,\n      token: null,\n      alias\n    },\n    whisper: [],\n    blind: false,\n    rolls: [],\n    sound: null,\n    emote: false,\n    flags: {\n      theatre: {\n        theatreMessage: true\n      }\n    },\n    _stats: {\n      compendiumSource: null,\n      duplicateSource: null,\n      coreVersion: game.release?.version,\n      systemId: game.system?.id,\n      systemVersion: game.system?.version,\n      createdTime: Date.now(),\n      modifiedTime: Date.now(),\n      lastModifiedBy: game.user?.id\n    }\n  };\n}\n\n/**\n * Determine if a given string is a valid hex color\n * @param {string} color \n * @returns {boolean}\n */\nexport function isValidColor(color: string): boolean {\n  if (!color || typeof color !== \"string\") return false;\n  if (color.substring(0, 1) === \"#\") color = color.substring(1);\n  switch (color.length) {\n    case 3: return /^[0-9A-F]{3}$/i.test(color);\n    case 6: return /^[0-9A-F]{6}$/i.test(color);\n    case 8: return /^[0-9A-F]{8}$/i.test(color);\n    default: return false;\n  }\n}\n\n/**\n * \n * @param url \n * @returns \n */\nexport function isValidURL(url: string): boolean {\n  try {\n    return Boolean(new URL(url, location.origin));\n  } catch (err: unknown) {\n    if (!(err instanceof TypeError)) throw err;\n    return false;\n  }\n}\n\n", "export class LocalizedError extends Error {\n  constructor(message?: string, subs?: { [x: string]: unknown }) {\n    if (message) super(game.i18n?.format(`THEATREAUTOMATION.ERRORS.${message}`, subs))\n    else super();\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class ActorNotActiveError extends LocalizedError {\n  constructor() {\n    super(\"ACTORNOTACTIVE\");\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class ActorNotStagedError extends LocalizedError {\n  constructor() {\n    super(\"ACTORNOTSTAGED\");\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidActorError extends LocalizedError {\n  constructor() {\n    super(\"INVALIDACTOR\");\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidFlyinError extends LocalizedError {\n  constructor(flyin: string) {\n    super(\"INVALIDFLYIN\", { flyin });\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidFontColorError extends LocalizedError {\n  constructor(color: string) {\n    super(\"INVALIDCOLOR\", { color });\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidFontError extends LocalizedError {\n  constructor(font: string) {\n    super(\"INVALIDFONT\", { font });\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidFontSizeError extends LocalizedError {\n  constructor(size: number) {\n    super(\"INVALIDSIZE\", { size });\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidStandingError extends LocalizedError {\n  constructor(standing: string) {\n    super(\"INVALIDSTANDING\", { standing });\n  }\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class InvalidURLError extends LocalizedError {\n  constructor(url: string) {\n    super(\"INVALIDURL\", { url });\n  }\n\n}", "import { LocalizedError } from \"./LocalizedError\";\n\nexport class NoChatHookError extends LocalizedError {\n  constructor() {\n    super(\"NOCHATHOOK\");\n  }\n}", "/* eslint-disable @typescript-eslint/no-unsafe-assignment */\nimport { coerceActor } from \"./coercion\";\nimport { InvalidActorError } from \"./errors\";\n\n/**\n * Checks whether or not an {@link Actor} is added to the Theatre Inserts stage.\n * @param {string} id ID fo the {@link Actor} to check\n */\nexport function isActorStaged(id: string): boolean\n/**\n * Checks whether or not an {@link Actor} is added to the Theatre Inserts stage.\n * @param {string} name Name of the {@link Actor} to check\n */\nexport function isActorStaged(name: string): boolean\n/**\n * Checks whether or not an {@link Actor} is added to the Theatre Inserts stage.\n * @param {Actor} actor {@link Actor} object to check\n */\nexport function isActorStaged(actor: Actor): boolean\nexport function isActorStaged(arg: unknown): boolean {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  return !!theatre.getNavItemById(`theatre-${actor.id}`);\n}\n\n/**\n * Stages an {@link Actor} if necessary.\n * @param {string} id ID of the {@link Actor}\n */\nexport function stageActor(id: string): void\n/**\n * Stages an {@link Actor} if necessary.\n * @param {string} name Name of the {@link Actor}\n */\nexport function stageActor(name: string): void\n/**\n * Stages an {@link Actor} if necessary.\n * @param {Actor} actor {@link Actor} object\n */\nexport function stageActor(actor: Actor): void\nexport function stageActor(arg: unknown): void {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  if (!isActorStaged(actor))\n    Theatre.addToNavBar(actor);\n}\n\n/**\n * Handles unstaging an {@link Actor}\n * @param {string} id ID of the {@link Actor}\n */\nexport function unstageActor(id: string): void\n/**\n * Handles unstaging an {@link Actor}\n * @param {string} name Name of the {@link Actor}\n */\nexport function unstageActor(name: string): void\n/**\n * Handles unstaging an {@link Actor}\n * @param {Actor} actor {@link Actor} object\n */\nexport function unstageActor(actor: Actor): void\nexport function unstageActor(arg: unknown): void {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  if (isActorStaged(actor)) {\n    theatre.handleNavItemMouseUp({\n      currentTarget: theatre.getNavItemById(`theatre-${actor.id}`),\n      button: 2,\n      ctrlKey: true\n    });\n  }\n}", "/* eslint-disable @typescript-eslint/no-unsafe-assignment */\nimport { coerceActor } from \"./coercion\";\nimport { TWEEN_WAIT_TIME } from \"./constants\";\nimport { wait } from \"./misc\";\nimport { isActorStaged, stageActor } from \"./staging\";\nimport { InvalidActorError } from \"./errors\";\n\n/**\n * Handles staging and activating the insert for an {@link Actor}\n * @param {string} id ID of the {@link Actor}\n */\nexport function activateActor(id: string): Promise<void>\n/**\n * Handles staging and activating the insert for an {@link Actor}\n * @param {string} name Name of the {@link Actor}\n */\nexport function activateActor(name: string): Promise<void>\n/**\n * Handles staging and activating the insert for an {@link Actor}\n * @param {Actor} actor {@link Actor} to activate.\n */\nexport function activateActor(actor: Actor): Promise<void>\nexport function activateActor(arg: unknown): Promise<void> {\n  const actor = coerceActor(arg);\n\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  if (!isActorStaged(actor)) stageActor(actor);\n\n  theatre.handleNavItemMouseUp({\n    currentTarget: theatre.getNavItemById(`theatre-${actor.id}`),\n    button: 2\n  });\n\n  return wait(TWEEN_WAIT_TIME);\n}\n\n\n\n/**\n * Handles deactivating and possibly unstaging an (@link Actor).\n * @param {string} id ID of the {@link Actor} to deactivate\n * @param {boolean} [unstage=false] Whether or not to remove the {@link Actor} from the Theatre Inserts stage\n */\nexport function deactivateActor(id: string, unstage?: boolean): Promise<void>\n/**\n * Handles deactivating and possibly unstaging an (@link Actor).\n * @param {string} name Name of the {@link Actor} to deactivate\n * @param {boolean} [unstage=false] Whether or not to remove the {@link Actor} from the Theatre Inserts stage\n */\nexport function deactivateActor(name: string, unstage?: boolean): Promise<void>\n/**\n * Handles deactivating and possibly unstaging an (@link Actor).\n * @param {Actor} actor The {@link Actor} object to deactivate.\n * @param {boolean} [unstage=false] Whether or not to remove the {@link Actor} from the Theatre Inserts stage\n */\nexport function deactivateActor(actor: Actor, unstage?: boolean): Promise<void>\nexport function deactivateActor(arg: unknown, unstage?: boolean): Promise<void> {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  // Deactivate\n  theatre.removeInsertById(`theatre-${actor.id}`, false);\n  // Unstage?\n  if (unstage) {\n    theatre.handleNavItemMouseUp({\n      currentTarget: theatre.getNavItemById(`theatre-${actor.id}`),\n      button: 2,\n      ctrlKey: true\n    });\n  }\n\n  // clearEmote(actor);\n  return wait(TWEEN_WAIT_TIME);\n}\n\n\n/**\n * Checks whether or not a given {@link Actor}'s insert is active.\n * @param {string} id ID of the {@link Actor}\n */\nexport function isActorActive(id: string): boolean\n/**\n * Checks whether or not a given {@link Actor}'s insert is active.\n * @param {name} name Name of the {@link Actor}\n */\nexport function isActorActive(name: string): boolean\n/**\n * Checks whether or not a given {@link Actor}'s insert is active.\n * @param {Actor} actor {@link Actor} object\n */\nexport function isActorActive(actor: Actor): boolean\nexport function isActorActive(arg: unknown): boolean {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  const navItem: HTMLElement = theatre.getNavItemById(`theatre-${actor.id}`);\n  // They are not staged\n  if (!navItem) return false;\n  return navItem.classList.contains(\"theatre-control-nav-bar-item-active\");\n}\n\n/**\n * Returns the {@link Actor} that is currently speaking, if any.\n * @returns {Actor | null} {@link Actor}\n */\nexport function currentlySpeaking(): Actor | null {\n  if (theatre.speakingAs) {\n    const [, id] = (<string>theatre.speakingAs).split(\"-\");\n    const actor = coerceActor(id);\n    return actor ?? null;\n  } else {\n    return null;\n  }\n}\n\n/**\n * Retrieves a list of {@link Actor}s whose inserts are active.\n * @returns {Actor[]} {@link Actor}[]\n */\nexport function currentlyActive(): Actor[] {\n  const activeNavItems = $(\".theatre-control-nav-bar img.theatre-control-nav-bar-item-active\")\n    .map(function () {\n      return this.getAttribute(\"imgid\");\n    })\n    .toArray();\n\n  return activeNavItems.map(elemId => {\n    const [, id] = elemId.split(\"-\");\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access\n    return game.actors.get(id);\n  })\n    .filter(elem => !!elem) as Actor[];\n\n}", "import { activateActor, isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { InvalidActorError } from \"./errors\";\n\n/**\n * Sets an emote on an {@link Actor}'s message\n * @param {string} id The {@link Actor}'s id\n * @param {string} emote \n */\nexport function setEmote(id: string, emote: string): Promise<void>\n/**\n * Sets an emote on an {@link Actor}'s message\n * @param {string} name The {@link Actor}'s name\n * @param {string} emote \n */\nexport function setEmote(name: string, emote: string): Promise<void>\n/**\n * Sets an emote on an {@link Actor}'s message\n * @param {Actor} actor The {@link Actor} object\n * @param emote \n */\nexport function setEmote(actor: Actor, emote: string): Promise<void>\nexport function setEmote(arg: unknown, emote: string): Promise<void> {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  return doSetEmote(actor, emote);\n}\n\nasync function doSetEmote(actor: Actor, emote: string): Promise<void> {\n  if (!isActorActive(actor)) await activateActor(actor);\n  theatre.setUserEmote(\n    game.user?.id,\n    `theatre-${actor.id}`,\n    \"emote\",\n    emote,\n    false\n  );\n}\n\n/**\n * Clears an emote from an {@link Actor}'s insert\n * @param {string} id ID of the {@link Actor}\n */\nexport function clearEmote(id: string): void\n/**\n * Clears an emote from an {@link Actor}'s insert\n * @param {string} name Name of the {@link Actor}\n */\nexport function clearEmote(name: string): void\nexport function clearEmote(arg: unknown): void {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  theatre.setUserEmote(game.user?.id, `theatre-${actor.id}`, \"emote\", \"\", false);\n}\n\n", "import { NARRATOR_WAIT_TIME } from \"./constants\";\nimport { sendChatMessage, wait } from \"./misc\";\n\n/**\n * Returns whether or not the narrator bar is active.\n * @returns {boolean}\n */\nexport function isNarratorBarActive(): boolean {\n  return $(\".theatre-control-btn .theatre-icon-narrator\").parent().hasClass(\"theatre-control-nav-bar-item-speakingas\");\n}\n\n/**\n * Activate narrator bar.\n */\nexport async function activateNarratorBar(): Promise<void> {\n  theatre.toggleNarratorBar(true, false);\n  await wait(NARRATOR_WAIT_TIME)\n}\n\n/**\n * Deactivates narrator bar.\n */\nexport async function deactivateNarratorBar(): Promise<void> {\n  theatre.toggleNarratorBar(false, false);\n  await wait(NARRATOR_WAIT_TIME);\n}\n\n/**\n * Sends a message via the narrator bar\n * @param {string} message Message to send\n */\nexport async function sendNarration(message: string): Promise<void> {\n  if (!isNarratorBarActive()) await activateNarratorBar();\n  sendChatMessage(\"narrator\", message);\n}", "import { isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { ActorNotActiveError, InvalidActorError, InvalidFlyinError } from \"./errors\";\nimport { isNarratorBarActive } from \"./narration\";\n\n/**\n * Retrieves a list of valid text flyin animation names.\n */\nexport function getFlyinAnimations(): string[] {\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n  return Object.keys((<any>Theatre).FLYIN_ANIMS);\n}\n\n/** Simply returns if a given string is in our list of flyins */\nfunction isValidFlyin(name: string): boolean {\n  return getFlyinAnimations().includes(name);\n}\n\n/**\n * Sets the text fly-in style of the insert we are currently speaking as.\n * @param {Flyin} flyin A {@link Flyin} preset\n */\nexport function setTextFlyin(flyin: string): void\n/**\n * Sets the text fly-in style of the insert for a particular {@link Actor}.\n * This {@link Actor}'s insert MUST be active.\n * @param {Flyin} flyin A {@link Flyin} preset\n * @param {string} id {@link Actor} id\n */\nexport function setTextFlyin(flyin: string, id: string): void\n/**\n * Sets the text fly-in style of the insert for a particular {@link Actor}.\n * This {@link Actor}'s insert MUST be active.\n * @param {Flyin} flyin A {@link Flyin} preset\n * @param {string} name {@link Actor} name\n */\nexport function setTextFlyin(flyin: string, name: string): void\n/**\n * Sets the text fly-in style of the insert for a particular {@link Actor}.\n * This {@link Actor}'s insert MUST be active.\n * @param {Flyin} flyin A {@link Flyin} preset\n * @param {Actor} actor {@link Actor}\n */\nexport function setTextFlyin(flyin: string, actor: Actor): void\n/**\n * Sets the text fly-in style of the insert for a particular {@link Actor}.\n * This {@link Actor}'s insert MUST be active.\n * @param {Flyin} flyin A {@link Flyin} preset\n * @param {Token} token {@link Token}\n */\nexport function setTextFlyin(flyin: string, token: Token): void\nexport function setTextFlyin(flyin: string, id: \"narrator\"): void\nexport function setTextFlyin(flyin: string, arg?: unknown): void {\n  if (!isValidFlyin(flyin)) throw new InvalidFlyinError(flyin);\n  if (arg === \"narrator\") {\n    theatre.theatreNarrator.setAttribute(\"textflyin\", flyin);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    if (!isActorActive(actor)) throw new ActorNotActiveError();\n    theatre.setUserEmote(game.user?.id, `theatre-${actor.id}`, \"textflyin\", flyin, false);\n  } else {\n    theatre.setUserEmote(game.user?.id, theatre.speakingAs, \"textflyin\", flyin, false);\n  }\n}\n\n/**\n * Retrieves the configured text {@link Flyin} for the actor we're currently speaking as.\n */\nexport function getTextFlyin(): string\n/**\n * Retrieves the configured text {@link Flyin} for a given {@link Actor}\n * @param {string} id {@link Actor} id\n */\nexport function getTextFlyin(id: string): string\n/**\n * Retrieves the configured text {@link Flyin} for a given {@link Actor}\n * @param {string} name {@link Actor} name\n */\nexport function getTextFlyin(name: string): string\n/**\n * Retrieves the configured text {@link Flyin} for a given {@link Actor}\n * @param {Actor} actor {@link Actor}\n */\nexport function getTextFlyin(actor: Actor): string\n/**\n * Retrieves the configured text {@link Flyin} for a given {@link Actor}\n * @param {Token} token {@link Token}\n */\nexport function getTextFlyin(token: Token): string\nexport function getTextFlyin(arg?: unknown): string {\n  if (arg === \"narrator\") {\n    return (theatre.theatreNarrator.getAttribute(\"textflyin\") ?? getFlyinAnimations()[0]);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-return\n    return theatre.getInsertById(`theatre-${actor.id}`).textFlyin;\n  } else if (isNarratorBarActive()) {\n    return theatre.theatreNarrator.getAttribute(\"textflyin\") ?? \"\";\n  } else if (theatre.speakingAs) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-return\n    return (theatre.getInsertById(theatre.speakingAs).textFlyin ?? \"\");\n  } else {\n    throw new InvalidActorError();\n  }\n}\n", "\n/** Icon to prepend to log messages, to make it easier to locate them in the console. */\nconst LOG_ICON: string = \"\uD83C\uDFAD\";\nconst LOG_PREFIX: string = `${LOG_ICON} ${__MODULE_TITLE__}`;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype LogFunction = (...data: any[]) => void;\n\nexport const log = wrappedConsoleFunc(console.log);\nexport const warn = wrappedConsoleFunc(console.warn);\nexport const error = wrappedConsoleFunc(console.error);\nexport const info = wrappedConsoleFunc(console.info);\n\nfunction wrappedConsoleFunc(original: LogFunction): LogFunction {\n  return function (this: unknown, ...args: unknown[]): void {\n    const shouldLog: boolean = __DEV__ ? true : typeof args[0] === \"boolean\" ? args[0] : false;\n    const actualArgs = args;\n\n\n    if (shouldLog)\n      original(LOG_PREFIX, \"|\", ...actualArgs);\n\n    // console.log(LOG_PREFIX, \"|\", ...actualArgs);\n  }\n}\n", "import { currentlyActive, currentlySpeaking, isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { ActorNotActiveError, InvalidActorError, InvalidFontColorError, InvalidFontError, InvalidFontSizeError } from \"./errors\";\nimport { log } from \"./log\";\nimport { isValidColor, isValidURL } from \"./misc\";\n\nexport type FontSize = 1 | 2 | 3;\n\nexport interface FontConfig {\n  name: string;\n  size: FontSize;\n  color: string;\n}\n\nconst DEFAULT_FONT_NAME = getFonts()[0];\nconst DEFAULT_FONT_SIZE = 2;\nconst DEFAULT_FONT_COLOR = \"#ffffff\";\n\n/**\n * Retrieves a list of fonts that Theatre Inserts knows about\n */\nexport function getFonts(): string[] {\n\n  // // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-argument\n  // return (<any>document.fonts.entries()).toArray().reduce((prev: string | any[], curr: { family: any; }[]) => prev.includes(curr[0].family) ? prev : [...prev, curr[0].family], []) as string[];\n  return [\n    ...Object.values(game.settings?.settings.get(\"theatre.nameFont\")?.choices ?? []),\n    ...FontConfig.getAvailableFonts()\n  ];\n}\n\n/**\n * Returns whether or not a given font name is a valid font that Theatre Inserts knows about\n * @param {string} font \n * @returns {boolean}\n */\nexport function isValidFont(font: string): boolean {\n  // if (isValidURL(font)) return true;\n  return getFonts().includes(font);\n}\n\n/**\n * Loads a remote font for use.\n * @param {string} name \n * @param {string} url \n * @returns \n */\nexport async function loadFont(name: string, url: string): Promise<boolean> {\n  if (!isValidURL(url)) throw new InvalidFontError(url);\n  return FontConfig.loadFont(name, {\n    editor: false,\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    fonts: [\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      { urls: [url] } as any\n    ]\n  })\n}\n\n/**\n * Retrieves {@link FontConfig} for the currently speaking or active {@link Actor} if there is only one\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(): FontConfig\n/**\n * Retrieves {@link FontConfig} for a given {@link Actor}\n * @param {string} id {@link Actor}'s id\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(id: string): FontConfig\n/**\n * Retrieves {@link FontConfig} for a given {@link Actor}\n * @param {string} name {@link Actor}'s name\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(name: string): FontConfig\n/**\n * Retrieves {@link FontConfig} for a given {@link Actor}\n * @param {Actor} actor {@link Actor}\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(actor: Actor): FontConfig\n/**\n * Retrieves {@link FontConfig} for a given {@link Actor}\n * @param {Token} token {@link Token}\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(token: Token): FontConfig\n/**\n * Retrieves {@link FontConfig} for the narrator\n * @returns {FontConfig} {@link FontConfig}\n */\nexport function getFont(name: \"narrator\"): FontConfig\nexport function getFont(arg?: unknown): FontConfig {\n  if (arg === \"narrator\") {\n    return {\n      name: theatre.theatreNarrator.getAttribute(\"textfont\") || DEFAULT_FONT_NAME,\n      color: theatre.theatreNarrator.getAttribute(\"textcolor\") || DEFAULT_FONT_COLOR,\n      size: (parseInt(theatre.theatreNarrator.getAttribute(\"textsize\") ?? \"\") || DEFAULT_FONT_SIZE) as FontSize\n    };\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    return {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n      name: insert.textFont || DEFAULT_FONT_NAME,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n      color: insert.textColor || DEFAULT_FONT_COLOR,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-unsafe-member-access\n      size: (parseInt(insert.textSize) || DEFAULT_FONT_SIZE) as FontSize\n    }\n  } else {\n    let actor: Actor | null = null;\n    const speaking = currentlySpeaking();\n    const active = currentlyActive();\n    if (speaking instanceof Actor) actor = speaking;\n    else if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    return {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n      name: insert.textFont || DEFAULT_FONT_NAME,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n      color: insert.textColor || DEFAULT_FONT_COLOR,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-unsafe-member-access\n      size: (parseInt(insert.textSize) || DEFAULT_FONT_SIZE) as FontSize\n    }\n  }\n}\n\n/**\n * Sets font settings for the currently speaking, or active {@link Actor} if only one\n * @param {FontConfig} config {@link FontConfig}\n */\nexport function setFont(config: Partial<FontConfig>): void\n/**\n * Sets font settings for a given {@link Actor}\n * @param {FontConfig} config {@link FontConfig}\n * @param {string} id {@link Actor}'s id\n */\nexport function setFont(config: Partial<FontConfig>, id: string): void\n/**\n * Sets font settings for a given {@link Actor}\n * @param {FontConfig} config {@link FontConfig}\n * @param {string} name {@link Actor}'s name\n */\nexport function setFont(config: Partial<FontConfig>, name: string): void\n/**\n * Sets font settings for a given {@link Actor}\n * @param {FontConfig} config {@link FontConfig}\n * @param {Actor} actor {@link Actor}\n */\nexport function setFont(config: Partial<FontConfig>, actor: Actor): void\n/**\n * Sets font settings for a given {@link Actor}\n * @param {FontConfig} config {@link FontConfig}\n * @param {Token} token {@link Token}\n */\nexport function setFont(config: Partial<FontConfig>, token: Token): void\n/**\n * Sets font settings for the narrator\n * @param {FontConfig} config {@link FontConfig}\n */\nexport function setFont(config: Partial<FontConfig>, name: \"narrator\"): void\nexport function setFont(config: Partial<FontConfig>, arg?: unknown): void {\n  if (config.name && !isValidFont(config.name)) throw new InvalidFontError(config.name);\n  if (config.size && !(config.size > 0 && config.size < 4)) throw new InvalidFontSizeError(config.size);\n  if (config.color && !isValidColor(config.color)) throw new InvalidFontColorError(config.color);\n  if (arg === \"narrator\") {\n    if (config.name) theatre.theatreNarrator.setAttribute(\"textfont\", config.name);\n    if (config.size) theatre.theatreNarrator.setAttribute(\"textsize\", config.size.toString());\n    if (config.color) theatre.theatreNarrator.setAttribute(\"textcolor\", config.color);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.name) insert.textFont = config.name;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.color) insert.textColor = config.color;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.size) insert.textSize = config.size;\n  } else {\n    let actor: Actor | null = null;\n    const speaking = currentlySpeaking();\n    const active = currentlyActive();\n\n    if (speaking instanceof Actor) actor = speaking;\n    else if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.name) insert.textFont = config.name;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.color) insert.textColor = config.color;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (config.size) insert.textSize = config.size;\n\n  }\n}\n\n\n/**\n * Retrieve the current font for a given {@link Actor}\n * @param {string} id {@link Actor} id\n */\nexport function getFontName(id: string): string | null\n/**\n * Retrieve the current font for a given {@link Actor}\n * @param {string} name {@link Actor} name\n */\nexport function getFontName(name: string): string | null\n/**\n * Retrieve the current font for a given {@link Actor}\n * @param {Actor} actor {@link Actor}\n */\nexport function getFontName(actor: Actor): string | null\n/**\n * Retrieve the current font for a given {@link Actor}\n * @param {Token} token {@link Actor}'s associated {@link Token}\n */\nexport function getFontName(token: Token): string | null\n/**\n * Retrieve the current font for a given {@link Actor}\n * @param {\"narrator\"} name Retrieve the font specifically for the narrator\n */\nexport function getFontName(name: \"narrator\"): string | null\n/**\n * Retrieve the current font for the currently speaking or active (if only one) {@link Actor}\n */\nexport function getFontName(): string\nexport function getFontName(arg?: unknown): string | null {\n  if (arg === \"narrator\") {\n    return (theatre.theatreNarrator.getAttribute(\"textfont\") as string) ?? null;\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`).textFont ?? null;\n  } else if (currentlySpeaking()) {\n    const actor = currentlySpeaking();\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`).textFont ?? null;\n  } else if (currentlyActive().length) {\n    const active = currentlyActive();\n    if (active.length > 1) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${active[0].id}`).textFont ?? null;\n\n  } else {\n    throw new InvalidActorError();\n  }\n}\n\n/**\n * Sets the currently active/speaking actor's font\n * @param {string} font \n */\nexport function setFontName(font: string): void\n/**\n * Sets the font of a specific {@link Actor}\n * @param {string} font Name of the font\n * @param {string} id {@link Actor}'s id\n */\nexport function setFontName(font: string, id: string): void\n/**\n * Sets the font of a specific {@link Actor}\n * @param {string} font Name of the font\n * @param {string} name Name of the {@link Actor}\n */\nexport function setFontName(font: string, name: string): void\n/**\n * Sets the font of a specific {@link Actor}\n * @param {string} font Name of the font\n * @param {Actor} actor {@link Actor}\n */\nexport function setFontName(font: string, actor: Actor): void\n/**\n * Sets the font of a specific {@link Actor}\n * @param {string} font Name of the font\n * @param {Token} token {@link Token} associated with the {@link Actor}\n */\nexport function setFontName(font: string, token: Token): void\n/**\n * Sets the font of the narrator\n * @param {string} font \n * @param {\"narrator\"} name Just the string \"narrator\"\n */\nexport function setFontName(font: string, name: \"narrator\"): void\nexport function setFontName(font: string, arg?: unknown): void {\n  if (!isValidFont(font)) throw new InvalidFontError(font);\n  if (arg === \"narrator\") {\n    theatre.theatreNarrator.setAttribute(\"textfont\", font);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    if (!isActorActive(actor)) throw new ActorNotActiveError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    theatre.getInsertById(`theatre-${actor.id}`).textFont = font;\n  } else if (currentlySpeaking()) {\n    const actor = currentlySpeaking();\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    theatre.getInsertById(`theatre-${actor.id}`).textFont = font;\n  } else if (currentlyActive() && currentlyActive().length === 1) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    theatre.getInsertById(`theatre-${currentlyActive()[0].id}`).textFont = font;\n  } else {\n    throw new InvalidActorError();\n  }\n}\n\n\n/**\n * Retrieves the font size for the currently speaking / active actor if there is just one\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(): FontSize\n/**\n * Retrieves the font size for a given {@link Actor}'s insert.\n * @param {string} id {@link Actor}'s id\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(id: string): FontSize\n/**\n * Retrieves the font size for a given {@link Actor}'s insert.\n * @param {string} name {@link Actor}'s name\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(name: string): FontSize\n/**\n * Retrieves the font size for a given {@link Actor}'s insert.\n * @param {Actor} actor {@link Actor}\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(actor: Actor): FontSize\n/**\n * Retrieves the font size for a given {@link Actor}'s insert.\n * @param {Token} token {@link Token}\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(token: Token): FontSize\n/**\n * Retrieves the font size for the narrator.\n * @param {\"narrator\"} name\n * @returns {number} Size, 1-3\n */\nexport function getFontSize(name: \"narrator\"): FontSize\nexport function getFontSize(arg?: unknown): FontSize {\n  if (arg === \"narrator\") {\n    const size = parseInt(theatre.theatreNarrator.getAttribute(\"textsize\") as string);\n    if (size > 0 && size < 4) return size as FontSize;\n    else throw new InvalidFontSizeError(size);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`)?.textSize || 1;\n  } else {\n    // Get currently speakingas/active\n    const current = currentlySpeaking();\n    const active = currentlyActive()[0];\n    const actor = current ? current : active ? active : null;\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`)?.textSize || 1;\n  }\n}\n\n/**\n * Set the font size of the currently speaking/active actor if there is only one\n * @param {FontSize} size Size, from 1-3\n */\nexport function setFontSize(size: FontSize): void\n/**\n * Set the font size of a particular {@link Actor}'s insert.\n * @param {FontSize} size Size, from 1-3\n * @param {string} id ID of the {@link Actor}\n */\nexport function setFontSize(size: FontSize, id: string): void\n/**\n * Set the font size of a particular {@link Actor}'s insert.\n * @param {FontSize} size Size, from 1-3\n * @param {string} name Name of the {@link Actor}\n */\nexport function setFontSize(size: FontSize, name: string): void\n/**\n * Set the font size of a particular {@link Actor}'s insert.\n * @param {FontSize} size Size, from 1-3\n * @param {Actor} actor {@link Actor}\n */\nexport function setFontSize(size: FontSize, actor: Actor): void\n/**\n * Set the font size of a particular {@link Actor}'s insert.\n * @param {FontSize} size Size, from 1-3\n * @param {Token} token {@link Token}\n */\nexport function setFontSize(size: FontSize, token: Token): void\n/**\n* Set the font size of a particular {@link Actor}'s insert.\n * @param {FontSize} size Size, from 1-3\n * @param {\"narrator\"} name\n */\nexport function setFontSize(size: FontSize, name: \"narrator\"): void\nexport function setFontSize(size: FontSize, arg?: unknown): void {\n  if (size < 1 || size > 3) throw new InvalidFontSizeError(size);\n  if (arg === \"narrator\") {\n    theatre.theatreNarrator.setAttribute(\"textsize\", size.toString());\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    log(\"Arg:\", arg, actor);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    insert.textSize = size;\n  } else {\n    let actor: Actor | null = null;\n    const speaking = currentlySpeaking();\n    if (speaking instanceof Actor) actor = speaking;\n    const active = currentlyActive();\n    if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    insert.textSize = size;\n  }\n}\n\n/**\n * Retrieves the font color of the {@link Actor} currently speaking or active, if there is only one\n * @returns {string}\n */\nexport function getFontColor(): string\n/**\n * Retrieves the font color of a given {@link Actor}\n * @param {string} id {@link Actor}'s id\n */\nexport function getFontColor(id: string): string\n/**\n * Retrieves the font color of a given {@link Actor}\n * @param {string} name {@link Actor}'s name\n */\nexport function getFontColor(name: string): string\n/**\n * Retrieves the font color of a given {@link Actor}\n * @param {Actor} actor {@linK Actor}\n */\nexport function getFontColor(actor: Actor): string\n/**\n * Retrieves the font color of a given {@link Actor}\n * @param {Token} token {@link Token}\n */\nexport function getFontColor(token: Token): string\n/**\n * Retrieves the font color of the narrator\n */\nexport function getFontColor(name: \"narrator\"): string\nexport function getFontColor(arg?: unknown): string {\n  if (arg === \"narrator\") {\n    return theatre.theatreNarrator.getAttribute(\"textcolor\") ?? \"#ffffff\";\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return insert.textColor ?? \"#ffffff\";\n  } else {\n    let actor: Actor | null = null;\n    const speaking = currentlySpeaking();\n    const active = currentlyActive();\n    if (speaking instanceof Actor) actor = speaking;\n    else if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-member-access\n    return insert.textColor ?? \"#ffffff\";\n  }\n}\n\n/**\n * Sets the font color of the {@link Actor} currently speaking, or active if there is only one\n * @param {string} color Hex code representing the color to set\n */\nexport function setFontColor(color: string): void\n/**\n * Set the font color of a given {@link Actor}\n * @param {string} color Hex code representing the color to set\n * @param {string} id {@link Actor}'s id\n */\nexport function setFontColor(color: string, id: string): void\n/**\n * Set the font color of a given {@link Actor}\n * @param {string} color Hex code representing the color to set\n * @param {string} name {@link Actor}'s name\n */\nexport function setFontColor(color: string, name: string): void\n/**\n * Set the font color of a given {@link Actor}\n * @param {string} color Hex code representing the color to set\n * @param {Actor} actor {@link Actor}\n */\nexport function setFontColor(color: string, actor: Actor): void\n/**\n * Set the font color of a given {@link Actor}\n * @param {string} color Hex code representing the color to set\n * @param {Token} token {@link Token}\n */\nexport function setFontColor(color: string, token: Token): void\n/**\n * Sets the font color for the narrator.\n * @param {string} color Hex code representing the color to set\n */\nexport function setFontColor(color: string, name: \"narrator\"): void\nexport function setFontColor(color: string, arg?: unknown): void {\n  if (!isValidColor(color)) throw new InvalidFontColorError(color);\n\n  if (arg === \"narrator\") {\n    theatre.theatreNarrator.setAttribute(\"textcolor\", color);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    insert.textColor = color;\n  } else {\n    let actor: Actor | null = null;\n    const speaking = currentlySpeaking();\n    const active = currentlyActive();\n\n    if (speaking instanceof Actor) actor = speaking;\n    else if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const insert = theatre.getInsertById(`theatre-${actor.id}`);\n    if (!insert) throw new ActorNotActiveError();\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    insert.textColor = color;\n  }\n}\n", "import { isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { ActorNotActiveError, InvalidActorError, InvalidURLError } from \"./errors\";\n\n/**\n * Retrieves the current image for an {@link Actor}'s insert.  If the insert is active, will retrieve the image directly from the actual insert, otherwise uses the actor's configuration.\n * @param {string} id \n * @returns {string} Path to the image\n */\nexport function getImage(id: string): string\n/**\n * Retrieves the current image for an {@link Actor}'s insert.  If the insert is active, will retrieve the image directly from the actual insert, otherwise uses the actor's configuration.\n * @param {string} name\n * @returns {string} Path to the image\n */\nexport function getImage(name: string): string\n/**\n * Retrieves the current image for an {@link Actor}'s insert.  If the insert is active, will retrieve the image directly from the actual insert, otherwise uses the actor's configuration.\n * @param {Actor} {@link Actor}\n * @returns {string} Path to the image\n */\nexport function getImage(actor: Actor): string\n/**\n * Retrieves the current image for an {@link Actor}'s insert.  If the insert is active, will retrieve the image directly from the actual insert, otherwise uses the actor's configuration.\n * @param {Token} token {@link Token}\n * @returns {string} Path to the image\n */\nexport function getImage(token: Token): string\nexport function getImage(arg: unknown): string {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  if (isActorActive(actor))\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`)?.portrait.texture.textureCacheIds[1] as string;\n  return getBaseImage(actor);\n}\n\n/**\n * Retrieves the base Theatre Insert image for a given {@link Actor}\n * @param {string} id \n */\nexport function getBaseImage(id: string): string\n/**\n * Retrieves the base Theatre Insert image for a given {@link Actor}\n * @param {string} name \n */\nexport function getBaseImage(name: string): string\n/**\n * Retrieves the base Theatre Insert image for a given {@link Actor}\n * @param {Actor} actor {@link Actor}\n */\nexport function getBaseImage(actor: Actor): string\n/**\n * Retrieves the base Theatre Insert image for a given {@link Actor}\n * @param {Token} }token {@link Token}\n */\nexport function getBaseImage(token: Token): string\nexport function getBaseImage(arg: unknown): string {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n  return ((<any>actor).flags?.theatre?.baseinsert || (<any>actor).img) as string;\n}\n\n/**\n * Sets the base Theatre Insert image for an {@link Actor}\n * @param {string} id \n * @param {string} url \n */\nexport function setBaseImage(id: string, url: string): Promise<void>\n/**\n * Sets the base Theatre Insert image for an {@link Actor}\n * @param {string} name \n * @param {string} url \n */\nexport function setBaseImage(name: string, url: string): Promise<void>\n/**\n * Sets the base Theatre Insert image for an {@link Actor}\n * @param {Actor} actor {@link Actor}\n * @param {string} url \n */\nexport function setBaseImage(actor: Actor, url: string): Promise<void>\n/**\n * Sets the base Theatre Insert image for an {@link Actor}\n * @param {Token} token {@link Token}\n * @param url \n */\nexport function setBaseImage(token: Token, url: string): Promise<void>\nexport function setBaseImage(arg: unknown, url: string): Promise<void> {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  return actor.setFlag(\"theatre\", \"baseinsert\", url).then(() => { });\n}\n\n/**\n * Sets the image for an {@link Actor}'s insert\n * @param {string} id \n * @param {string} image \n */\nexport function setImage(id: string, image: string): Promise<void>\n/**\n * Sets the image for an {@link Actor}'s insert\n * @param {string} name \n * @param {string} image \n */\nexport function setImage(name: string, image: string): Promise<void>\n/**\n * Sets the image for an {@link Actor}'s insert\n * @param {Actor} actor {@link Actor}\n * @param {string} image \n */\nexport function setImage(actor: Actor, image: string): Promise<void>\n/**\n * Sets the image for an {@link Actor}'s insert\n * @param {Token} token {@link Token}\n * @param {string} image \n */\nexport function setImage(token: Token, image: string): Promise<void>\nexport function setImage(arg: unknown, image: string): Promise<void> {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  if (!isActorActive(actor)) throw new ActorNotActiveError();\n\n  return srcExists(image)\n    .then(val => {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n      if (val) return (<any>theatre)._AddTextureResource(image, image, `theatre-${actor.id}`, false);\n      else throw new InvalidURLError(image);\n    }).then(() => { });\n}", "import { log } from \"../log\";\nimport EventEmitter from 'events';\nimport { ActorContext, EventMap, IntroductionApplicationData, IntroductionApplicationFormData, PlaylistContext } from \"./interfaces\";\nimport { DynamicSelect } from '../dynamicSelect.js';\nimport { getActorContext, getPlaylistContext } from \"./sharedFunctionality\";\nimport { MaybePromise, GetDataReturnType } from \"@league-of-foundry-developers/foundry-vtt-types/src/types/utils.mjs\";\nimport { coerceActor, coercePlaylist, coerceSound } from \"../coercion\";\nimport { InvalidActorError } from \"../errors\";\n\n\n\n\n\n/**\n * \n */\nexport class IntroductionApplication extends FormApplication<FormApplicationOptions, IntroductionApplicationData> implements EventEmitter<EventMap> {\n\n  protected events = new EventEmitter<EventMap>();\n\n  constructor(object: IntroductionApplicationData, options?: Partial<FormApplicationOptions>) {\n    const mergedObject = foundry.utils.mergeObject(\n      {\n        musicWait: 0,\n        portraitWait: 0,\n        closeWait: 0,\n        selectedActor: null,\n        selectedSound: null\n      },\n      object\n    )\n\n    super(mergedObject, options);\n    log(\"Options:\", this.options);\n  }\n\n  protected _updateObject(_event: Event, formData?: IntroductionApplicationFormData): Promise<unknown> {\n    log(\"updateObject:\", formData);\n    if (formData) {\n\n      const actor = (formData.actorSelect ? coerceActor(formData.actorSelect) : null);\n      if (!(actor instanceof Actor)) throw new InvalidActorError();\n\n      let playlist: Playlist | undefined;\n      let sound: PlaylistSound | undefined;\n      if (formData.soundSelect) {\n        const [playlistId, soundId] = formData.soundSelect.split(\"-\");\n        playlist = coercePlaylist(playlistId);\n        if (playlist instanceof Playlist) sound = coerceSound(soundId, playlist);\n      }\n\n      this.object = {\n        selectedActor: actor,\n        selectedSound: sound,\n        musicWait: formData.musicWait ?? 0,\n        portraitWait: formData.portraitWait ?? 0,\n        introMessage: formData.introMessage ?? \"\",\n        closeWait: formData.closeWait ?? 0\n      }\n    }\n\n    return Promise.resolve();\n  }\n\n  protected override _render(force?: boolean, options?: Application.RenderOptions<FormApplicationOptions>): Promise<void> {\n    return super._render(force, options)\n      .then(() => { this.emit(\"render\"); });\n  }\n\n  override async close(options?: FormApplication.CloseOptions): Promise<void> {\n    await super.close(options);\n    if (options?.submit) this.emit(\"submit\", this.object);\n    else this.emit(\"cancel\");\n    this.emit(\"close\");\n  }\n\n  override getData(options?: Partial<FormApplicationOptions>): MaybePromise<GetDataReturnType<FormApplication.FormApplicationData<FormApplicationOptions, IntroductionApplicationData>>> {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access\n    const playlists: PlaylistContext[] = game.playlists.contents.map((playlist: Playlist) => getPlaylistContext(playlist)) as PlaylistContext[];\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-call, @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-assignment\n    const actors: ActorContext[] = game.actors.contents.map((actor: Actor) => ({\n      ...getActorContext(actor),\n      ...(this.object?.selectedActor?.id === actor.id ? { selected: true } : { selected: false })\n    }));\n\n    const localContext = {\n      actors,\n      playlists,\n      introMessage: this.object.introMessage\n    };\n\n    const parentContext = super.getData(options);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n    if (typeof (<any>parentContext).then === \"function\") {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return (<Promise<any>>parentContext).then((data: object) => foundry.utils.mergeObject(data, localContext));\n    } else {\n      return foundry.utils.mergeObject(parentContext, localContext);\n    }\n  }\n\n  static get defaultOptions() {\n    return foundry.utils.mergeObject(\n      super.defaultOptions,\n      {\n        title: game.i18n?.localize(\"THEATREAUTOMATION.DIALOGS.INTRO.TITLE\") || \"\",\n        template: `/modules/${__MODULE_ID__}/templates/intro/application.hbs`,\n        closeOnSubmit: true,\n        submitOnClose: false,\n        submitOnChange: false\n      }\n    );\n  }\n\n\n  activateListeners(html: JQuery<HTMLElement>) {\n    super.activateListeners(html);\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-call\n    new DynamicSelect(\"#actorSelect\", {\n      name: \"actorSelect\",\n      onChange: (value: string, text: string, option: unknown) => {\n        log(\"Dynamic select:\", value, text, option);\n      }\n    });\n\n\n    html.find(\"input[type='number']\").on(\"focus\", function () { $(this).trigger(\"select\"); });\n\n    html.find(\"[data-action='submit']\").on(\"click\", (e) => {\n      this.close({ submit: true });\n      e.preventDefault();\n    });\n    html.find(\"[data-action='cancel']\").on(\"click\", (e) => {\n      this.close({ submit: false });\n      e.preventDefault();\n    })\n  }\n\n  // #region EventEmitter Implementation\n\n  addListener<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.addListener<K>(eventName, listener);\n    return this;\n  }\n  on<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.on<K>(eventName, listener);\n    return this;\n  }\n  once<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.once<K>(eventName, listener);\n    return this;\n  }\n  removeListener<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.removeListener<K>(eventName, listener);\n    return this;\n  }\n  off<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.off<K>(eventName, listener);\n    return this;\n  }\n  removeAllListeners(eventName?: unknown): this {\n    this.events.removeAllListeners(eventName);\n    return this;\n  }\n  setMaxListeners(n: number): this {\n    this.events.setMaxListeners(n);\n    return this;\n  }\n  getMaxListeners(): number {\n    return this.events.getMaxListeners();\n  }\n  listeners<K>(eventName: keyof EventMap | K): (K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never)[] {\n    return this.events.listeners<K>(eventName);\n  }\n  rawListeners<K>(eventName: keyof EventMap | K): (K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never)[] {\n    return this.events.rawListeners<K>(eventName);\n  }\n  emit<K>(eventName: keyof EventMap | K, ...args: K extends keyof EventMap ? EventMap[K] : never): boolean {\n    return this.events.emit<K>(eventName, ...args);\n  }\n  listenerCount<K>(eventName: keyof EventMap | K, listener?: (K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never)): number {\n    return this.events.listenerCount<K>(eventName, listener);\n  }\n  prependListener<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.prependListener<K>(eventName, listener);\n    return this;\n  }\n  prependOnceListener<K>(eventName: keyof EventMap | K, listener: K extends keyof EventMap ? EventMap[K] extends unknown[] ? (...args: EventMap[K]) => void : never : never): this {\n    this.events.prependOnceListener<K>(eventName, listener);\n    return this;\n  }\n  eventNames(): (\"render\" | \"submit\" | \"cancel\" | \"close\")[] {\n    return this.events.eventNames();\n  }\n\n  // #endregion\n\n}", "/*\n * Created by David Adams\n * https://codeshack.io/dynamic-select-images-html-javascript/\n *\n * Released under the MIT license\n */\nexport class DynamicSelect {\n  constructor(element, options = {}) {\n    let defaults = {\n      placeholder: \"Select an option\",\n      columns: 1,\n      name: \"\",\n      width: \"\",\n      height: \"\",\n      data: [],\n      onChange: function () {},\n    };\n    this.options = Object.assign(defaults, options);\n    this.selectElement =\n      typeof element === \"string\" ? document.querySelector(element) : element;\n    for (const prop in this.selectElement.dataset) {\n      if (this.options[prop] !== undefined) {\n        this.options[prop] = this.selectElement.dataset[prop];\n      }\n    }\n    this.name = this.selectElement.getAttribute(\"name\")\n      ? this.selectElement.getAttribute(\"name\")\n      : \"dynamic-select-\" + Math.floor(Math.random() * 1000000);\n    if (!this.options.data.length) {\n      let options = this.selectElement.querySelectorAll(\"option\");\n      for (let i = 0; i < options.length; i++) {\n        this.options.data.push({\n          value: options[i].value,\n          text: options[i].innerHTML,\n          img: options[i].getAttribute(\"data-img\"),\n          selected: options[i].selected,\n          html: options[i].getAttribute(\"data-html\"),\n          imgWidth: options[i].getAttribute(\"data-img-width\"),\n          imgHeight: options[i].getAttribute(\"data-img-height\"),\n        });\n      }\n    }\n    this.element = this._template();\n    this.selectElement.replaceWith(this.element);\n    this._updateSelected();\n    this._eventHandlers();\n  }\n\n  _template() {\n    let optionsHTML = \"\";\n    for (let i = 0; i < this.data.length; i++) {\n      let optionWidth = 100 / this.columns;\n      let optionContent = \"\";\n      if (this.data[i].html) {\n        optionContent = this.data[i].html;\n      } else {\n        optionContent = `\n                    ${\n                      this.data[i].img\n                        ? `<img src=\"${this.data[i].img}\" alt=\"${\n                            this.data[i].text\n                          }\" class=\"${\n                            this.data[i].imgWidth && this.data[i].imgHeight\n                              ? \"dynamic-size\"\n                              : \"\"\n                          }\" style=\"${\n                            this.data[i].imgWidth\n                              ? \"width:\" + this.data[i].imgWidth + \";\"\n                              : \"\"\n                          }${\n                            this.data[i].imgHeight\n                              ? \"height:\" + this.data[i].imgHeight + \";\"\n                              : \"\"\n                          }\">`\n                        : \"\"\n                    }\n                    ${\n                      this.data[i].text\n                        ? '<span class=\"dynamic-select-option-text\">' +\n                          this.data[i].text +\n                          \"</span>\"\n                        : \"\"\n                    }\n                `;\n      }\n      optionsHTML += `\n                <div class=\"dynamic-select-option${\n                  this.data[i].value == this.selectedValue\n                    ? \" dynamic-select-selected\"\n                    : \"\"\n                }${\n        this.data[i].text || this.data[i].html ? \"\" : \" dynamic-select-no-text\"\n      }\" data-value=\"${this.data[i].value}\" style=\"width:${optionWidth}%;${\n        this.height ? \"height:\" + this.height + \";\" : \"\"\n      }\">\n                    ${optionContent}\n                </div>\n            `;\n    }\n    let template = `\n            <div class=\"dynamic-select ${this.name}\"${\n      this.selectElement.id ? ' id=\"' + this.selectElement.id + '\"' : \"\"\n    } style=\"${this.width ? \"width:\" + this.width + \";\" : \"\"}${\n      this.height ? \"height:\" + this.height + \";\" : \"\"\n    }\">\n                <input type=\"hidden\" name=\"${this.name}\" value=\"${\n      this.selectedValue\n    }\">\n                <div class=\"dynamic-select-header\" style=\"${\n                  this.width ? \"width:\" + this.width + \";\" : \"\"\n                }${\n      this.height ? \"height:\" + this.height + \";\" : \"\"\n    }\"><span class=\"dynamic-select-header-placeholder\">${\n      this.placeholder\n    }</span></div>\n                <div class=\"dynamic-select-options\" style=\"${\n                  this.options.dropdownWidth\n                    ? \"width:\" + this.options.dropdownWidth + \";\"\n                    : \"\"\n                }${\n      this.options.dropdownHeight\n        ? \"height:\" + this.options.dropdownHeight + \";\"\n        : \"\"\n    }\">${optionsHTML}</div>\n            </div>\n        `;\n    let element = document.createElement(\"div\");\n    element.innerHTML = template;\n    return element;\n  }\n\n  _eventHandlers() {\n    this.element\n      .querySelectorAll(\".dynamic-select-option\")\n      .forEach((option) => {\n        option.onclick = () => {\n          this.element\n            .querySelectorAll(\".dynamic-select-selected\")\n            .forEach((selected) =>\n              selected.classList.remove(\"dynamic-select-selected\")\n            );\n          option.classList.add(\"dynamic-select-selected\");\n          this.element.querySelector(\".dynamic-select-header\").innerHTML =\n            option.innerHTML;\n          this.element.querySelector(\"input\").value =\n            option.getAttribute(\"data-value\");\n          this.data.forEach((data) => (data.selected = false));\n          this.data.filter(\n            (data) => data.value == option.getAttribute(\"data-value\")\n          )[0].selected = true;\n          this.element\n            .querySelector(\".dynamic-select-header\")\n            .classList.remove(\"dynamic-select-header-active\");\n          this.options.onChange(\n            option.getAttribute(\"data-value\"),\n            option.querySelector(\".dynamic-select-option-text\")\n              ? option.querySelector(\".dynamic-select-option-text\").innerHTML\n              : \"\",\n            option\n          );\n        };\n      });\n    this.element.querySelector(\".dynamic-select-header\").onclick = () => {\n      this.element\n        .querySelector(\".dynamic-select-header\")\n        .classList.toggle(\"dynamic-select-header-active\");\n    };\n    if (\n      this.selectElement.id &&\n      document.querySelector('label[for=\"' + this.selectElement.id + '\"]')\n    ) {\n      document.querySelector(\n        'label[for=\"' + this.selectElement.id + '\"]'\n      ).onclick = () => {\n        this.element\n          .querySelector(\".dynamic-select-header\")\n          .classList.toggle(\"dynamic-select-header-active\");\n      };\n    }\n    document.addEventListener(\"click\", (event) => {\n      if (\n        !event.target.closest(\".\" + this.name) &&\n        !event.target.closest('label[for=\"' + this.selectElement.id + '\"]')\n      ) {\n        this.element\n          .querySelector(\".dynamic-select-header\")\n          .classList.remove(\"dynamic-select-header-active\");\n      }\n    });\n  }\n\n  _updateSelected() {\n    if (this.selectedValue) {\n      this.element.querySelector(\".dynamic-select-header\").innerHTML =\n        this.element.querySelector(\".dynamic-select-selected\").innerHTML;\n    }\n  }\n\n  get selectedValue() {\n    let selected = this.data.filter((option) => option.selected);\n    selected = selected.length ? selected[0].value : \"\";\n    return selected;\n  }\n\n  set data(value) {\n    this.options.data = value;\n  }\n\n  get data() {\n    return this.options.data;\n  }\n\n  set selectElement(value) {\n    this.options.selectElement = value;\n  }\n\n  get selectElement() {\n    return this.options.selectElement;\n  }\n\n  set element(value) {\n    this.options.element = value;\n  }\n\n  get element() {\n    return this.options.element;\n  }\n\n  set placeholder(value) {\n    this.options.placeholder = value;\n  }\n\n  get placeholder() {\n    return this.options.placeholder;\n  }\n\n  set columns(value) {\n    this.options.columns = value;\n  }\n\n  get columns() {\n    return this.options.columns;\n  }\n\n  set name(value) {\n    this.options.name = value;\n  }\n\n  get name() {\n    return this.options.name;\n  }\n\n  set width(value) {\n    this.options.width = value;\n  }\n\n  get width() {\n    return this.options.width;\n  }\n\n  set height(value) {\n    this.options.height = value;\n  }\n\n  get height() {\n    return this.options.height;\n  }\n}\ndocument\n  .querySelectorAll(\"[data-dynamic-select]\")\n  .forEach((select) => new DynamicSelect(select));\n", "import { ActorContext, PlaylistContext, SoundContext } from \"./interfaces\";\n\n/**\n * Returns a simplified version of an {@link Actor}, appropriate for passing to an application form\n * @param {Actor} actor {@link Actor}\n * @returns {ActorContext} {@link ActorContext}\n */\nexport function getActorContext(actor: Actor): ActorContext {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const castActor: any = actor;\n  return {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n    id: castActor.id,\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n    name: castActor.name,\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, @typescript-eslint/no-unsafe-member-access\n    img: castActor.img,\n    selected: false\n  }\n}\n\nexport function getPlaylistContext(playlist: Playlist): PlaylistContext {\n  return {\n    id: playlist.id ?? \"\",\n    name: playlist.name,\n    sounds: playlist.sounds.map(sound => getSoundContext(sound))\n  }\n}\n\n/**\n * \n * @param sound \n * @returns \n */\nexport function getSoundContext(sound: PlaylistSound): SoundContext {\n  return {\n    id: sound.id ?? \"\",\n    name: sound.name,\n    duration: sound.sound?.duration || 0,\n    selected: false\n  }\n}", "import { activateActor, isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { ActorNotActiveError, ActorNotStagedError, InvalidActorError } from \"./errors\";\nimport { getTextFlyin, setTextFlyin } from \"./flyins\";\n\nimport { sendChatMessage } from \"./misc\";\nimport { isActorStaged, stageActor } from \"./staging\";\n\n/**\n * Sends a message as an {@link Actor}\n * @param {string} id The {@link Actor}'s id\n * @param {string} message \n * @param {Flyin} [flyin=\"typewriter\"] {@link Flyin} Text fly-in animation type -- Will be reset after this message\n */\nexport function sendMessage(id: string, message: string, flyin?: string): Promise<void>\n/**\n * Sends a message as an {@link Actor}\n * @param {string} name The {@link Actor}'s name\n * @param {string} message \n * @param {Flyin} [flyin=\"typewriter\"] {@link Flyin} Text fly-in animation type -- Will be reset after this message\n */\nexport function sendMessage(name: string, message: string, flyin?: string): Promise<void>\n/**\n * Sends a message as an {@link Actor}\n * @param {Actor} actor The {@link Actor} object\n * @param {string} message \n * @param {Flyin} [flyin=\"typewriter\"] {@link Flyin} Text fly-in animation type -- Will be reset after this message\n */\nexport function sendMessage(actor: Actor, message: string, flyin?: string): Promise<void>\nexport function sendMessage(arg: unknown, message: string, flyin: string = \"typewriter\"): Promise<void> {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  if (!isActorStaged(actor)) stageActor(actor);\n  return (isActorActive(actor) ? Promise.resolve() : activateActor(actor))\n    .then(() => {\n      if (!isActorSpeaking(actor)) setSpeakingAs(actor);\n      const oldFlyin = getTextFlyin();\n      setTextFlyin(flyin);\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n      sendChatMessage((<any>actor).name, message);\n      setTextFlyin(oldFlyin);\n    })\n}\n\nfunction setSpeakingAs(actor: Actor): void {\n  if (!isActorStaged(actor)) throw new ActorNotStagedError();\n  if (!isActorActive) throw new ActorNotActiveError();\n\n\n  const navItem: HTMLElement = theatre.getNavItemById(`theatre-${actor.id}`) as HTMLElement;\n  if (!navItem.classList.contains(\"theatre-control-nav-bar-item-speakingas\")) {\n    theatre.handleNavItemMouseUp({\n      currentTarget: navItem,\n      button: 0\n    });\n  }\n}\n\n/**\n * Returns whether or not a given {@link Actor} is activated in our chatbox\n * @param {string} name {@link Actor}'s name\n */\nexport function isActorSpeaking(name: string): boolean\n/**\n * Returns whether or not a given {@link Actor} is activated in our chatbox\n * @param {string} id {@link Actor}'s id\n */\nexport function isActorSpeaking(id: string): boolean\n/**\n * Returns whether or not a given {@link Actor} is activated in our chatbox\n * @param {Actor} actor {@link Actor}\n */\nexport function isActorSpeaking(actor: Actor): boolean\n/**\n * Returns whether or not a given {@link Actor} is activated in our chatbox\n * @param {Token} token {@link Token} associated with the {@link Actor}\n */\nexport function isActorSpeaking(token: Token): boolean\nexport function isActorSpeaking(arg: unknown): boolean {\n  const actor = coerceActor(arg);\n  if (!(actor instanceof Actor)) throw new InvalidActorError();\n  const navItem: HTMLElement = theatre.getNavItemById(`theatre-${actor.id}`) as HTMLElement;\n  return navItem.classList.contains(\"theatre-control-nav-bar-item-speakingas\");\n}\n\n", "import { coerceActor, coercePlaylist, coerceSound } from \"./coercion\";\nimport { InvalidActorError, InvalidSoundError } from \"./errors\";\n\n/**\n * Plays a given {@link PlaylistSound}\n * @param {PlaylistSound} sound {@link PlaylistSound} to play\n */\nexport function playSound(sound: PlaylistSound) {\n  sound?.parent?.playSound(sound);\n}\n\n/**\n * Fades a given sound out, by a given duration.\n * @param {PlaylistSound} sound {@link PlaylistSound} to fade\n * @param {number} [duration=500] Duration of the fade, in milliseconds\n * @returns {Promise<void>} A Promise<void> that resolves when the fade is complete.\n */\nexport function fadeOutSound(sound: PlaylistSound, duration: number = 500): Promise<void> {\n  return fadeSoundFrom(sound, duration, sound.sound?.volume || 0);\n}\n\n/**\n * Fades a given sound in, by a given duration\n * @param {PlaylistSound} sound {@link PlaylistSound} to fade in.\n * @param {number} [duration=500] Duration of the fade, in milliseconds.\n * @param {number} volume \n * @returns {Promise<void>} A Promise<void> that reoslves when the fade is complete.\n */\nexport function fadeInSound(sound: PlaylistSound, duration: number = 500, volume: number = 1): Promise<void> {\n  return fadeSoundFrom(sound, duration, 0, volume);\n}\n\n/**\n * Crossfades between two {@link PlaylistSound}s\n * @param {PlaylistSound} currentSound {@link PlaylistSound} that is currently playing, will be faded out\n * @param {PlaylistSound} newSound {@link PlaylistSound} that will be faded to\n * @param {number} [duration=500] Duration of hte fade out and in, in milliseconds\n * @param {number} [newSoundVolume=1] Ending volume of the new sound, from 0-1\n */\nexport function crossFadeSounds(currentSound: PlaylistSound, newSound: PlaylistSound, duration: number, newSoundVolume: number = 1): Promise<void> {\n  return Promise.all([\n    fadeOutSound(currentSound, duration),\n    fadeInSound(newSound, duration, newSoundVolume)\n  ])\n    .then(() => { });\n}\n\n/**\n * \n * @param {PlaylistSound} sound {@link PlaylistSound} to fade\n * @param {number} duration Duration of the fade, in milliseconds\n * @param {number} [startVolume] Starting volume from which to fade, from 0-1\n * @param {number} [endVolume=1] Ending volume to which to fade, from 0-1\n * @returns {Promise<void>} A Promise<void> that resolves when the fade is complete.\n */\nfunction fadeSoundFrom(sound: PlaylistSound, duration: number, startVolume: number = 0, endVolume: number = 1): Promise<void> {\n  if (!(sound?.sound instanceof Sound)) throw new InvalidSoundError();\n\n  if (typeof startVolume === \"undefined\") startVolume = sound.sound.volume || 0;\n  sound.sound.volume = startVolume;\n\n  return sound.sound.fade(endVolume, { duration });\n}\n\n\n/**\n * Retrieves a {@link PlaylistSound} named \"Intro\" on a {@link Playlist} that shares a name with the supplied {@link Actor}\n * @param {Actor} actor {@link Actor} for which to get the default sound\n * @returns {PlaylistSound|undefined} The {@link PlaylistSound}, or undefined if it was not found.\n */\nexport function getDefaultIntroSong(actor: unknown): PlaylistSound | undefined {\n  const actualActor = coerceActor(actor);\n  if (!(actualActor instanceof Actor)) throw new InvalidActorError();\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-explicit-any\n  const playlist = coercePlaylist((<any>actualActor).name);\n  if (!(playlist instanceof Playlist)) return;\n\n  const song = coerceSound(\"Intro\", playlist);\n  if (song instanceof PlaylistSound) return song;\n}", "import { activateActor, deactivateActor } from \"./activation\";\nimport { IntroductionApplicationData } from \"./applications/interfaces\";\nimport { IntroductionApplication } from \"./applications/IntroductionApplication\";\nimport { coerceActor } from \"./coercion\";\nimport { InvalidActorError } from \"./errors\";\nimport { sendMessage } from \"./messaging\";\nimport { wait } from \"./misc\";\nimport { playSound } from \"./sounds\";\n\n\n/**\n * Displays a form to gather data about an actor to introduce with optional music\n * @param {Actor} [selectedActor] {@link Actor} to default to selected\n * @returns {Promise<IntroductionApplicationData | undefined>} A promise that resolves with the data gathered from the form\n */\nexport async function getActorIntroData(selectedActor: unknown): Promise<IntroductionApplicationData | undefined> {\n  return new Promise((resolve, reject) => {\n    const actor = coerceActor(selectedActor);\n    if (selectedActor !== undefined && !(actor instanceof Actor)) reject(new InvalidActorError());\n    new IntroductionApplication({\n      ...(actor ? { selectedActor: actor } : {})\n    }).once(\"submit\", resolve)\n      .once(\"cancel\", () => { resolve(undefined); })\n      .render(true);\n  });\n\n}\n\n/**\n * Displays an actor's Theatre insert, sends a text message, optionally plays a sound\n * @param actor \n * @param message \n * @param portraitWait \n * @param musicWait \n * @param sound \n * @param closeWait\n */\nexport async function introduceActor(actor: unknown, message: string, portraitWait: number = 0, musicWait: number = 0, sound: PlaylistSound, closeWait: number = 0) {\n  const actualActor = coerceActor(actor);\n  if (!(actualActor instanceof Actor)) throw new InvalidActorError();\n\n  const promises: Promise<void>[] = [];\n  if (sound instanceof PlaylistSound)\n    promises.push(wait(musicWait).then(() => playSound(sound)));\n\n  promises.push(wait(portraitWait).then(() => {\n    if (message) return sendMessage(actualActor, message).then(() => { if (closeWait) return wait(closeWait).then(() => { deactivateActor(actualActor) }) });\n    else return activateActor(actualActor).then(() => { if (closeWait) return wait(closeWait).then(() => { deactivateActor(actualActor) }) });\n  }));\n\n  await Promise.all(promises);\n}\n", "import { currentlyActive, currentlySpeaking } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { InvalidActorError } from \"./errors\";\nimport { wait } from \"./misc\";\n\nexport function mirrorInsert(): Promise<void>\nexport function mirrorInsert(id: string): Promise<void>\nexport function mirrorInsert(name: string): Promise<void>\nexport function mirrorInsert(actor: Actor): Promise<void>\nexport function mirrorInsert(token: Token): Promise<void>\nexport function mirrorInsert(arg?: unknown): Promise<void> {\n  if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    theatre.mirrorInsertById(`theatre-${actor.id}`, false);\n    return wait(500);\n  } else {\n    const speaking = currentlySpeaking();\n    const active = currentlyActive();\n    let actor: Actor | null = null;\n    if (speaking instanceof Actor) actor = speaking;\n    else if (active.length === 1 && active[0] instanceof Actor) actor = active[0];\n\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    theatre.mirrorInsertById(`theatre-${actor.id}`);\n    return wait(500);\n  }\n}", "import { currentlySpeaking, isActorActive } from \"./activation\";\nimport { coerceActor } from \"./coercion\";\nimport { ActorNotActiveError, InvalidStandingError, InvalidActorError } from \"./errors\";\nimport { isNarratorBarActive } from \"./narration\";\n\n/**\n * Retrieves a list of known text standing animations.\n * @returns {string[]}\n */\nexport function getStandingAnimations(): string[] {\n  return [\n    \"none\",\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument, @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n    ...Object.keys((<any>Theatre).STANDING_ANIMS)\n  ];\n}\n\n/**\n * Returns whether or not a given string is a valid text standing animation name\n * @param {string} standing \n * @returns \n */\nexport function isValidStandingAnimation(standing: string): boolean {\n  return getStandingAnimations().includes(standing);\n}\n\n/**\n * Will set the text standing for the currently active {@link Actor}\n * @param {string} standing Text standing value\n */\nexport function setTextStanding(standing: string): void\n/**\n * Will set the text standing for a given {@link Actor}\n * @param {string} standing Text standing value\n * @param {string} id {@link Actor} id\n */\nexport function setTextStanding(standing: string, id: string): void\n/**\n * Will set the text standing for a given {@link Actor}\n * @param {string} standing Text standing value\n * @param name \n */\nexport function setTextStanding(standing: string, name: string): void\n/**\n  * Will set the text standing for a given {@link Actor}\n * @param {string} standing Text standing value\n * @param actor \n */\nexport function setTextStanding(standing: string, actor: Actor): void\n/**\n * Will set the text standing for a given {@link Actor}\n * @param {string} standing Text standing value\n * @param token \n */\nexport function setTextStanding(standing: string, token: Token): void\n/**\n * Will set the text standing for the narrator\n * @param {string} standing Text standing value\n * @param {\"narrator\"} name \n */\nexport function setTextStanding(standing: string, name: \"narrator\"): void\nexport function setTextStanding(standing: string, arg?: unknown): void {\n  if (!isValidStandingAnimation(standing)) throw new InvalidStandingError(standing);\n  if (arg === \"narrator\") {\n    theatre.theatreNarrator.setAttribute(\"textstanding\", standing);\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    if (!isActorActive(actor)) throw new ActorNotActiveError();\n    theatre.setUserEmote(game.user?.id, `theatre-${actor.id}`, \"textstanding\", standing, false);\n  } else if (theatre.speakingAs) {\n    // Use current\n    theatre.setUserEmote(game.user?.id, theatre.speakingAs, \"textstanding\", standing, false);\n  } else if (isNarratorBarActive()) {\n    theatre.theatreNarrator.setAttribute(\"textstanding\", standing);\n  } else {\n    throw new InvalidActorError();\n  }\n}\n\n\n/**\n * Retrieves the currently configured text standing for the active {@link Actor}\n */\nexport function getTextStanding(): string\n/**\n * Retrieves the currently configured text standing for a given {@link Actor}\n * @param {string} id \n */\nexport function getTextStanding(id: string): string\n/**\n * Retrieves the currently configured text standing for a given {@link Actor}\n * @param {string} name \n */\nexport function getTextStanding(name: string): string\n/**\n * Retrieves the currently configured text standing for a given {@link Actor}\n * @param {Actor} actor {@link Actor}\n */\nexport function getTextStanding(actor: Actor): string\n/**\n * Retrieves the currently configured text standing for a given {@link Actor}\n * @param {Token} token {@link Token}\n */\nexport function getTextStanding(token: Token): string\n/**\n * Retrieves the currently configured text standing for the narrator.\n */\nexport function getTextStanding(name: \"narrator\"): string\nexport function getTextStanding(arg?: unknown): string {\n  if (arg === \"narrator\") {\n    return theatre.theatreNarrator.getAttribute(\"textstanding\") as string;\n  } else if (arg) {\n    const actor = coerceActor(arg);\n    if (!(actor instanceof Actor)) throw new InvalidActorError();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    return theatre.getInsertById(`theatre-${actor.id}`).textStanding as string;\n  } else if (isNarratorBarActive()) {\n    return theatre.theatreNarrator.getAttribute(\"textstanding\") as string;\n  } else {\n    const actor = currentlySpeaking();\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (actor instanceof Actor) return theatre.getInsertById(`theatre-${actor.id}`).textStanding as string;\n    throw new InvalidActorError();\n  }\n}\n", "import { activateActor, currentlyActive, currentlySpeaking, deactivateActor, isActorActive } from \"./activation\";\nimport { clearEmote, setEmote } from \"./emotes\";\nimport { getTextFlyin, setTextFlyin } from \"./flyins\";\nimport { getFont, getFontSize, isValidFont, setFontName, getFontName, setFontSize, setFont, getFontColor, setFontColor, loadFont } from './fonts';\nimport { getBaseImage, getImage, setBaseImage, setImage } from \"./image\";\nimport { getActorIntroData, introduceActor } from \"./introduction\";\nimport { sendMessage } from \"./messaging\";\nimport { mirrorInsert } from \"./mirror\";\nimport { wait } from \"./misc\";\nimport { activateNarratorBar, deactivateNarratorBar, isNarratorBarActive, sendNarration } from \"./narration\";\nimport { isActorStaged, stageActor, unstageActor } from \"./staging\";\nimport { getTextStanding, setTextStanding } from \"./standing\";\n\nexport default {\n  wait,\n  activateActor,\n  deactivateActor,\n  isActorActive,\n  isActorStaged,\n  stageActor,\n  unstageActor,\n  sendMessage,\n  setEmote,\n  clearEmote,\n  getActorIntroData,\n  introduceActor,\n\n  isNarratorBarActive,\n  activateNarratorBar,\n  deactivateNarratorBar,\n  sendNarration,\n\n  setTextFlyin,\n  getTextFlyin,\n\n  getTextStanding,\n  setTextStanding,\n\n  currentlySpeaking,\n  currentlyActive,\n\n  isValidFont,\n  getFontName,\n  setFontName,\n  getFontSize,\n  setFontSize,\n  getFontColor,\n  setFontColor,\n  getFont,\n  setFont,\n  loadFont,\n\n  mirrorInsert,\n\n  getImage,\n  setImage,\n  getBaseImage,\n  setBaseImage\n};\n", "/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n\nimport { NoChatHookError } from \"../errors\";\n\n\nconst POP_LINE_START = `let tweenId = \"portraitPop\";`;\nconst POP_LINE_END = `Theatre.instance._addDockTween(insert.imgId, tween, tweenId);`\n\nconst FLASH_LINE_START = `tweenId = \"portraitFlash\";`;\nconst FLASH_LINE_END = `Theatre.instance._addDockTween(insert.imgId, tween, tweenId);`;\n\nexport default class SettingsHandler {\n  static {\n    Hooks.on(\"theatreDockActive\", () => {\n      if (SettingsHandler.GetSetting<boolean>(\"hideActorName\")) SettingsHandler.HideActorNames();\n      if (SettingsHandler.GetSetting<boolean>(\"hideTextBox\")) SettingsHandler.HideTextBox();\n      if (SettingsHandler.GetSetting<boolean>(\"hideTypingIcon\")) SettingsHandler.HideTypingIcons();\n    });\n\n\n    Hooks.once(\"ready\", () => {\n      if (game.settings?.get(__MODULE_ID__, \"hideTextBox\")) SettingsHandler.HideTextBox();\n      else SettingsHandler.ShowTextBox();\n\n      SettingsHandler.OverrideChatHook();\n\n    });\n  }\n\n  /**\n   * .... please do not look at this shameful, shameful fucntion\n   */\n  static OverrideChatHook() {\n    const hook = SettingsHandler.FindChatHook();\n    if (!hook) throw new NoChatHookError();\n\n\n    let hasFunctionDeclaration: boolean = false;\n    // Filter out stuff for later\n    const lines: string[] = hook.fn.toString().split(\"\\n\")\n      .filter((line: string, index: number, arr: string[]) => {\n        // If we start with a \"function\" remove it\n        if (line.trim().startsWith(\"function\")) {\n          hasFunctionDeclaration = true;\n          return false;\n        }\n        // If we start with a \"function\", also remove the last line.\n        if (hasFunctionDeclaration && index === arr.length - 1) return false;\n\n        // Remove calls to KHelpers\n        if (line.trim().startsWith(\"KHelpers\")) return false;\n\n        // Remove calls to Logger\n        if (line.trim().startsWith(\"Logger\")) return false;\n\n        return true;\n      });\n\n    // Add conditionals for our tweens\n    const popStart = lines.findIndex(line => line.trim() === POP_LINE_START);\n    if (popStart !== -1) lines.splice(popStart, 0, `if (game.settings.get(\"${__MODULE_ID__}\", \"suppressPopAnimation\") !== true) {`);\n    const popEnd = lines.findIndex((line: string, index: number) => index > popStart && line.trim() === POP_LINE_END);\n    if (popEnd !== -1) lines.splice(popEnd + 1, 0, `}`);\n\n    const flashStart = lines.findIndex(line => line.trim() === FLASH_LINE_START);\n    if (flashStart !== -1) lines.splice(flashStart, 0, `if (game.settings.get(\"${__MODULE_ID__}\", \"suppressFlashAnimation\") !== true) {`);\n    const flashEnd = lines.findIndex((line: string, index: number) => index > flashStart && line.trim() === FLASH_LINE_END);\n    if (flashEnd !== -1) lines.splice(flashEnd + 1, 0, `}`);\n\n\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    const newFn = new Function(\"chatEntity\", \"_\", \"userId\", lines.join(\"\\n\"));\n\n\n    hook.fn = newFn;\n  }\n\n\n  // eslint-disable-next-line @typescript-eslint/no-unsafe-function-type\n  static FindChatHook(): { hook: string, fn: Function, id: number, once: boolean } | undefined {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-call, @typescript-eslint/no-explicit-any\n    return (<any>Hooks.events).createChatMessage.find((elem: any) => elem.fn.toString().split(\"\\n\").some((line: string) => line.trim() === \"let theatreId = null;\"));\n  }\n\n  static GetSetting<t = unknown>(setting: string): t {\n    return game.settings?.get(__MODULE_ID__, setting) as t;\n  }\n\n  static HideActorNames() {\n    SettingsHandler.IterateDocks(dock => { dock.name = \"\"; });\n  }\n\n  static HideTypingIcons() {\n    setTimeout(() => {\n      SettingsHandler.IterateDocks(dock => {\n        if (!dock.typingBubble) return;\n        else dock.typingBubble.renderable = false;\n      })\n    }, 100);\n  }\n\n  static ShowTypingIcons() {\n    setTimeout(() => {\n      SettingsHandler.IterateDocks(dock => {\n        if (!dock.typingBubble) return;\n        else dock.typingBubble.renderable = true;\n      })\n    }, 100);\n  }\n\n  static HideTextBox() {\n    $(\"#theatre-bar\").css(\"opacity\", 0);\n  }\n\n  static ShowTextBox() {\n    $(\"#theatre-bar\").css(\"opacity\", 1);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static IterateDocks(func: (dock: any) => void): void {\n    theatre.portraitDocks.forEach(func);\n  }\n\n  static RegisterSettings() {\n    game.settings?.register(__MODULE_ID__, \"hideTextBox\", {\n      name: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDECHATBOX.NAME\"),\n      hint: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDECHATBOX.HINT\"),\n      default: false,\n      type: Boolean,\n      config: true,\n      scope: \"world\",\n      onChange: (value: boolean) => {\n        if (value) SettingsHandler.HideTextBox();\n        else SettingsHandler.ShowTextBox()\n      }\n    });\n\n    game.settings?.register(__MODULE_ID__, \"hideActorName\", {\n      name: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEACTORNAME.NAME\"),\n      hint: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEACTORNAME.HINT\"),\n      default: false,\n      type: Boolean,\n      config: true,\n      scope: \"world\",\n      onChange: (value: boolean) => {\n        if (value) SettingsHandler.HideActorNames();\n      }\n    });\n\n    game.settings?.register(__MODULE_ID__, \"hideTypingIcon\", {\n      name: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDETYPINGICON.NAME\"),\n      hint: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDETYPINGICON.HINT\"),\n      default: false,\n      type: Boolean,\n      config: true,\n      scope: \"world\",\n      onChange: hide => {\n        if (hide) SettingsHandler.HideTypingIcons();\n        else SettingsHandler.ShowTypingIcons();\n      }\n    });\n\n    game.settings?.register(__MODULE_ID__, \"suppressPopAnimation\", {\n      name: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEPOPANIMATION.NAME\"),\n      hint: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEPOPANIMATION.HINT\"),\n      default: false,\n      type: Boolean,\n      config: true,\n      scope: \"world\"\n    });\n\n    game.settings?.register(__MODULE_ID__, \"suppressFlashAnimation\", {\n      name: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEFLASHANIMATION.NAME\"),\n      hint: game.i18n?.localize(\"THEATREAUTOMATION.SETTINGS.HIDEFLASHANIMATION.HINT\"),\n      default: false,\n      type: Boolean,\n      config: true,\n      scope: \"world\"\n    });\n\n\n    // Hooks.on(\"theatre\")\n  }\n}\n/*\n\n*/", "/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport api from \"./lib/api\";\nimport SettingsHandler from \"./lib/applications/SettingsHandler\";\nimport { getFlyinAnimations } from \"./lib/flyins\";\nimport { getFonts } from \"./lib/fonts\";\nimport { getStandingAnimations } from \"./lib/standing\";\n\nHooks.once(\"init\", () => {\n  SettingsHandler.RegisterSettings();\n});\n\nHooks.once(\"ready\", async () => {\n  if (game instanceof Game && !game.modules.get(\"theatre\")?.active) {\n    ui.notifications?.error(game.i18n?.format(\"THEATREAUTOMATION.ERRORS.THEATREINSERTSNOTFOUND\", { MODULENAME: __MODULE_TITLE__ }));\n\n  } else {\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (<any>window).TheatreAutomation = api;\n\n    // Register templates\n    await loadTemplates([\n      `/modules/${__MODULE_ID__}/templates/intro/application.hbs`,\n    ]);\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (<any>window).TheatreAutomation.STANDING_NAMES = getStandingAnimations();\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (<any>window).TheatreAutomation.FLYIN_NAMES = getFlyinAnimations();\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (<any>window).TheatreAutomation.FONT_NAMES = getFonts();\n\n  }\n});\n"],
  "mappings": "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",
  "names": ["ReflectApply", "ReflectOwnKeys", "NumberIsNaN", "EventEmitter", "once", "options", "EventEmitter"]
}
