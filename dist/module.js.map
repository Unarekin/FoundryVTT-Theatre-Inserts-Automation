{
  "version": 3,
  "sources": ["../src/lib/log.ts", "../src/lib/coerceTypeOrId.ts", "../src/lib/misc.ts", "../src/lib/activateActor.ts", "../src/module.ts"],
  "sourcesContent": ["\n/** Icon to prepend to log messages, to make it easier to locate them in the console. */\nconst LOG_ICON: string = \"\uD83C\uDFAD\";\nconst LOG_PREFIX: string = `${LOG_ICON} ${__MODULE_TITLE__}`;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype LogFunction = (...data: any[]) => void;\n\nexport const log = wrappedConsoleFunc(console.log);\nexport const warn = wrappedConsoleFunc(console.warn);\nexport const error = wrappedConsoleFunc(console.error);\nexport const info = wrappedConsoleFunc(console.info);\n\nfunction wrappedConsoleFunc(original: LogFunction): LogFunction {\n  return function (this: unknown, ...args: unknown[]): void {\n    const shouldLog: boolean = __DEV__ ? true : typeof args[0] === \"boolean\" ? args[0] : false;\n    const actualArgs = args;\n\n\n    if (shouldLog)\n      original(LOG_PREFIX, \"|\", ...actualArgs);\n\n    // console.log(LOG_PREFIX, \"|\", ...actualArgs);\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-redundant-type-constituents */\n/* eslint-disable @typescript-eslint/no-unsafe-return */\n\nimport { log } from \"./log\";\n\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n\n/**\n * Retrieves an {@link Actor}\n * @param {unknown} arg A string id or name, or an {@link Actor}\n * @returns {Actor | undefined} {@link Actor} or undefined.\n */\nexport function coerceActor(arg: unknown): Actor | undefined {\n  log(\"Coercing:\", arg);\n  if (arg instanceof Actor) return arg;\n  if (typeof arg === \"string\") {\n    let actor = game.actors?.get(arg);\n    if (actor) return actor;\n    actor = game.actors?.getName(arg);\n    if (actor) return actor;\n  }\n}\n\n/**\n * Retrieves a {@link Playlist}\n * @param {unkown} arg A string id or name, or a {@link Playlist}\n * @returns {Playlist | undefined} {@link Playlist} or undefined\n */\nexport function coercePlaylist(arg: unknown): Playlist | undefined {\n  if (arg instanceof Playlist) return arg;\n  if (typeof arg === \"string\") {\n    let playlist = game.playlists?.get(arg);\n    if (playlist) return playlist;\n    playlist = game.playlists?.getName(arg);\n    if (playlist) return playlist;\n  }\n}\n\n/**\n * Retireves a {@link PlaylistSound} from a given {@link Playlist} by name, id, or {@link PlaylistSound}\n * @param {unknown} arg \n * @param {unknown} playlist\n */\nexport function coerceSound(arg: unknown, playlist: unknown): PlaylistSound | undefined {\n  if (arg instanceof PlaylistSound) return arg;\n\n  const actualPlaylist = coercePlaylist(playlist);\n  if (actualPlaylist && typeof arg === \"string\") {\n    let sound = actualPlaylist.sounds.get(arg);\n    if (sound instanceof PlaylistSound) return sound;\n    sound = actualPlaylist.sounds.getName(arg);\n    if (sound instanceof PlaylistSound) return sound;\n  }\n}\n\n/**\n * Retrieves an id for an {@link Actor}, given the id, name, or {@link Actor}\n * @param {unknown} arg \n */\nexport function coerceActorId(arg: unknown): string | undefined | null {\n  const actor = coerceActor(arg);\n  if (actor instanceof Actor) return actor.id;\n}\n\n/**\n * Retrieves an id for a given {@link Playlist}\n * @param {unknown} arg \n * @returns \n */\nexport function coercePlaylistId(arg: unknown): string | undefined | null {\n  const playlist = coercePlaylist(arg);\n  if (playlist instanceof Playlist) return playlist.id;\n}\n\n/**\n * Returns a {@link PlaylistSound} for a given id/name/{@link PlaylistSound} for a given {@link Playlist}\n * @param {unknown} arg \n * @param {unknown} playlist \n * @returns \n */\nexport function coerceSoundId(arg: unknown, playlist: unknown): string | undefined | null {\n  const sound = coerceSound(arg, playlist);\n  if (sound instanceof PlaylistSound) return sound.id;\n}", "/**\n * Waits a specified amount of time, then resolves.\n * @param {number} ms Time, in milliseconds, to wait.\n * @returns \n */\nexport async function wait(ms: number): Promise<void> {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  })\n}", "/* eslint-disable @typescript-eslint/no-redundant-type-constituents */\n/* eslint-disable @typescript-eslint/no-unsafe-argument */\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\n\n\n\n\nimport { coerceActor, coercePlaylist, coerceSound } from './coerceTypeOrId'\nimport { wait } from './misc';\n\nexport interface ActivateParams {\n  actor: string | Actor,\n  playlist?: string | Playlist,\n  sound?: string | PlaylistSound,\n  portraitWait?: number,\n  musicWait?: number,\n  ttl?: number\n}\n\n/**\n * Activates the insert for an {@link Actor}, staging it if necessary.\n * @param {string} id ID for the {@link Actor}\n * @returns {Promise<void>} A promise that resolves immediately.\n */\nexport function activateActor(id: string): void\n/**\n * Activates the insert for an {@link Actor}, staging it if necessary.\n * @param {Actor} actor The {@link Actor} to activate.\n * @returns {Promise<void>} A promise that resolves immediately.\n */\nexport function activateActor(actor: Actor): void\n/**\n * Activates the insert for an {@link Actor}, staging it if necessary.\n * @param {ActivateParams} params {@link ActivateParams}\n * @return {Promise<void>} A promise that resolves when all of ttl, musicWait, and portraitWait have elapsed.\n */\nexport function activateActor(params: ActivateParams): Promise<void>\nexport function activateActor(...args: unknown[]): Promise<void> {\n  let actor: Actor | undefined;\n  let playlist: Playlist | undefined;\n  let sound: PlaylistSound | undefined;\n\n  let musicWait = 0;\n  let portraitWait = 0;\n\n  let ttl = 0;\n\n\n  if (typeof args[0] === \"object\") {\n    const params = args[0] as ActivateParams;\n    actor = coerceActor(params.actor);\n    if (params.playlist) {\n      playlist = coercePlaylist(params.playlist);\n      if (!(playlist instanceof Playlist)) throw new Error(game.i18n?.localize(\"THEATREINSERTSMACROS.ERRORS.INVALIDPLAYLIST\"));\n    }\n    if (params.sound && playlist instanceof Playlist) {\n      sound = coerceSound(params.sound, playlist);\n      if (!(sound instanceof PlaylistSound)) throw new Error(game.i18n?.localize(\"THEATREINSERTSMACROS.ERRORS.INVALIDSOUND\"));\n    }\n    musicWait = params.musicWait ?? 0;\n    portraitWait = params.portraitWait ?? 0;\n    ttl = params.ttl ?? 0;\n\n  } else {\n    actor = coerceActor(args[0]);\n  }\n\n  if (!(actor instanceof Actor)) throw new Error(game.i18n?.localize(\"THEATREINSERTSMACROS.ERRORS.INVALIDACTOR\"));\n\n  // Stage if necessary\n  if (!theatre.getNavItemById(`theatre-${actor.id}`))\n    Theatre.addToNavBar(actor);\n\n  const promises: Promise<void>[] = [];\n  if (playlist instanceof Playlist && sound instanceof PlaylistSound)\n    promises.push(wait(musicWait ?? 0).then(() => { playlist.playSound(sound); }));\n\n  promises.push(wait(portraitWait ?? 0).then(() => {\n    theatre.handleNavItemMouseUp({\n      currentTarget: theatre.getNavItemById(`theatre-${actor.id}`),\n      button: 2\n    });\n  }));\n\n  if (ttl)\n    promises.push(wait(ttl));\n\n  return Promise.all(promises).then(() => { });\n\n}\n", "/* eslint-disable @typescript-eslint/no-unsafe-member-access */\n/* eslint-disable @typescript-eslint/no-unsafe-call */\nimport { activateActor } from \"./lib/activateActor\";\nimport { log } from \"./lib/log\";\n\n\nHooks.on(\"ready\", () => {\n  if (game instanceof Game && !game.modules.get(\"theatre\")?.active) {\n    ui.notifications?.error(game.i18n?.format(\"THEATREINSERTSMACROS.ERRORS.THEATREINSERTSNOTFOUND\", { MODULENAME: __MODULE_TITLE__ }));\n  } else {\n\n    const api: object = {\n      activateActor\n    };\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (<any>window).TheatreMacros = api;\n\n\n    log(`Ready!`);\n  }\n\n});"],
  "mappings": "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",
  "names": []
}
